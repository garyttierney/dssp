(typeattribute storage_unconfined_subj_type)

(block fixed_disk
	(blockinherit dev.storage_obj_blk))

(block fuse_storage
	(blockinherit dev.storage_obj_blk))

(block removable_storage
	(blockinherit dev.storage_obj_blk))

(block scsi_generic
	(blockinherit dev.storage_obj_blk))

(typeattribute storage_read_fixed_disk_subj_type)
(typeattribute storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type)

(typeattributeset storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type
	(not (storage_read_fixed_disk_subj_type storage_unconfined_subj_type)))

(neverallow storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (chr_file (read)))
(neverallow storage_not_read_fixed_disk_subj_type_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (blk_file (read)))

(typeattribute storage_write_fixed_disk_subj_type)
(typeattribute storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type)

(typeattributeset storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type
	(not (storage_write_fixed_disk_subj_type storage_unconfined_subj_type)))

(neverallow storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (chr_file (append write)))
(neverallow storage_not_write_fixed_disk_subj_type_or_storage_unconfined_subj_type
	fixed_disk.storage_dev (blk_file (append write)))

(typeattribute storage_read_scsi_generic_subj_type)
(typeattribute storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type)

(typeattributeset storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type
	(not (storage_read_scsi_generic_subj_type storage_unconfined_subj_type)))

(neverallow storage_not_read_scsi_generic_subj_type_or_storage_unconfined_subj_type
	scsi_generic.storage_dev (chr_file (read)))

(typeattribute storage_write_scsi_generic_subj_type)
(typeattribute storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type)

(typeattributeset storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type
	(not (storage_write_scsi_generic_subj_type storage_unconfined_subj_type)))

(neverallow storage_not_write_scsi_generic_subj_type_or_storage_unconfined_subj_type
	scsi_generic.storage_dev (chr_file (append write)))

(allow storage_unconfined_subj_type fixed_disk.storage_dev all_chr_file_perms_except_mounton_and_execmod)
(allow storage_unconfined_subj_type fixed_disk.storage_dev all_blk_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type fuse_storage.storage_dev all_chr_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type removable_storage.storage_dev all_blk_file_perms_except_mounton_and_execmod)

(allow storage_unconfined_subj_type scsi_generic.storage_dev all_chr_file_perms_except_mounton_and_execmod)
